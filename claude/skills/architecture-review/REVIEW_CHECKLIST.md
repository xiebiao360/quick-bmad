# 架构评审检查清单

本清单确保在实施和审查阶段不遗漏关键检查项。

---

## 阶段一：提案分析检查清单

### 代码理解
- [ ] 已读取所有直接相关的代码文件
- [ ] 已读取上游依赖（被修改代码调用的模块）
- [ ] 已读取下游依赖（调用被修改代码的模块）
- [ ] 理解当前架构的设计意图
- [ ] 识别现有的技术约束和限制

### 提案评估
- [ ] 从第一性原理分析提案的合理性
- [ ] 识别提案中的潜在隐患
- [ ] 评估对现有架构的影响范围
- [ ] 考虑是否有更优的解决方案
- [ ] 明确指出所有不合理之处（如有）

### 输出确认
- [ ] 已给出初步分析结论
- [ ] 已列出所有疑问点

---

## 阶段二：方案探索检查清单

### 需求澄清
- [ ] 已通过问询理解核心需求
- [ ] 已澄清所有关键决策点
- [ ] 已明确技术选型要求
- [ ] 已理解性能和扩展性期望
- [ ] 用户已确认可以开始实施，或已无疑问

### 方案设计
- [ ] 已设计至少一个可行方案
- [ ] 已从多个维度对比方案（如有多个）：
  - [ ] 架构清晰度
  - [ ] 实现复杂度
  - [ ] 可维护性
  - [ ] 代码侵入性
  - [ ] 未来扩展性
- [ ] 已明确推荐方案
- [ ] 已详细说明推荐理由
- [ ] 已规划实施步骤

### 输出确认
- [ ] 方案描述清晰完整
- [ ] 实施计划具体可执行
- [ ] 关键注意点已标注

---

## 阶段三：方案实施检查清单

### 架构设计（后端/全栈）

#### DDD 分层检查
- [ ] 领域层（Domain）：核心业务逻辑清晰
- [ ] 应用层（Application）：用例编排合理
- [ ] 基础设施层（Infrastructure）：技术实现独立
- [ ] 接口层（Interface）：对外暴露接口明确

#### 设计原则检查
- [ ] 单一职责原则（SRP）：每个模块职责单一
- [ ] 开闭原则（OCP）：对扩展开放，对修改关闭
- [ ] 里氏替换原则（LSP）：子类可替换父类
- [ ] 接口隔离原则（ISP）：接口精简，不臃肿
- [ ] 依赖倒置原则（DIP）：依赖抽象而非具体实现

#### 代码组织
- [ ] 高内聚：相关功能紧密组合
- [ ] 低耦合：模块间依赖最小化
- [ ] 清晰的依赖方向：无循环依赖
- [ ] 合理的依赖注入

### 前端代码质量

#### React 最佳实践（如适用）
- [ ] 组件职责单一，易于理解
- [ ] Hooks 使用合理：
  - [ ] useState/useReducer 状态管理清晰
  - [ ] useEffect 依赖项正确
  - [ ] useMemo/useCallback 使用得当
  - [ ] 自定义 Hooks 逻辑复用合理
- [ ] 避免 prop drilling，状态管理清晰
- [ ] 事件处理正确（避免内存泄漏）
- [ ] 组件性能优化合理（React.memo、懒加载等）

#### Vue 最佳实践（如适用）
- [ ] 组件职责单一
- [ ] Composition API 使用合理
- [ ] 响应式数据管理清晰
- [ ] 生命周期钩子使用正确
- [ ] 组件通信方式合理（props、emit、provide/inject）

#### 通用前端质量
- [ ] TypeScript 类型定义完整准确
- [ ] 样式组织清晰（CSS Modules/Styled Components/Tailwind 等）
- [ ] 无硬编码的魔法值
- [ ] 国际化处理（如需要）
- [ ] 无障碍性（Accessibility）考虑

### API响应结构（后端）

#### 统一响应格式（参考 API_RESPONSE_DESIGN.md）
- [ ] 已导入 `use liangx_core::{ApiResponse, error_codes};`
- [ ] Handler返回类型符合规范：`Result<Json<ApiResponse<T>>, (StatusCode, Json<ApiResponse<()>>)>`
- [ ] 成功响应使用 `ApiResponse::success(data)`
- [ ] 业务错误（余额不足等）返回 HTTP 200 + `business_error()`
- [ ] 技术错误（认证失败等）返回 HTTP 4xx/5xx + `error()`
- [ ] 错误码选择合理（优先使用通用错误码10000-19999）
- [ ] 错误消息清晰具体，无技术栈信息泄露
- [ ] HTTP状态码与业务状态码正确分层

### 通用代码质量

#### 错误处理
- [ ] 充分的错误捕获和处理
- [ ] 错误信息清晰有用
- [ ] 优雅的降级处理
- [ ] 避免静默失败

#### 代码可读性
- [ ] 命名清晰表意
- [ ] 逻辑流程易于理解
- [ ] 必要的注释（复杂逻辑）
- [ ] 避免过深的嵌套

#### 性能考虑
- [ ] 无明显的性能瓶颈
- [ ] 合理的算法复杂度
- [ ] 避免不必要的计算或渲染
- [ ] 资源使用合理（内存、网络等）

### 直面问题原则检查
- [ ] 未绕开核心问题
- [ ] 未采取简单 workaround
- [ ] 无模拟实现或 TODO 占位
- [ ] 问题已从根本上解决
- [ ] 如遇复杂问题，已重新评估方案

### 编译质量
- [ ] 无 TypeScript 类型错误
- [ ] 无 ESLint/TSLint 错误
- [ ] 无语法错误
- [ ] 能够正常编译/构建

---

## 阶段四：质量把关检查清单

### 修改文件清单
- [ ] 已列出所有修改的文件
- [ ] 已逐一审查每个文件

### 逻辑严谨性检查
- [ ] 业务逻辑正确
- [ ] 边界条件已处理：
  - [ ] 空值/null/undefined 情况
  - [ ] 空数组/空对象情况
  - [ ] 数值边界（0、负数、最大值等）
  - [ ] 字符串边界（空串、超长等）
- [ ] 异常情况已考虑：
  - [ ] 网络请求失败
  - [ ] 数据格式异常
  - [ ] 权限不足
  - [ ] 并发冲突
- [ ] 不会引入新的 bug
- [ ] 不会破坏现有功能

### 架构清晰性检查
- [ ] 分层清晰，符合设计原则
- [ ] 每个模块/组件职责单一
- [ ] 依赖关系合理，无循环依赖
- [ ] 符合 DDD 原则或相应的最佳实践
- [ ] 代码组织结构清晰

### 编译质量检查
- [ ] 无 TypeScript 类型错误
- [ ] 无 Lint 错误（已运行 lint 命令）
- [ ] 无语法错误
- [ ] 构建成功（已运行 build 命令）

### 完整性检查
- [ ] 所有需求点已实现
- [ ] 未遗漏特殊场景
- [ ] 相关配置已更新（如需要）
- [ ] 相关文档已更新（如需要）
- [ ] 单元测试已补充（如需要）
- [ ] 集成测试已补充（如需要）

### 正确性检查
- [ ] 实现符合设计方案
- [ ] 正确理解业务需求
- [ ] 符合技术规范和约定
- [ ] API 契约正确（如涉及接口变更）
- [ ] API响应结构符合规范（参考 API_RESPONSE_DESIGN.md）
- [ ] 数据模型正确（如涉及数据结构变更）

### 简洁性检查
- [ ] 无冗余代码
- [ ] 无过度设计
- [ ] 无不必要的抽象
- [ ] 逻辑流程简洁清晰
- [ ] 代码行数合理（单文件不超过 1000 行）

### 冗余代码清理
- [ ] 已移除未使用的导入
- [ ] 已移除注释掉的旧代码
- [ ] 已消除重复逻辑
- [ ] 已移除无用的变量或函数
- [ ] 已移除调试用的 console.log

### 最终审查
- [ ] 已运行所有必要的检查命令（lint/format/test）
- [ ] 所有检查均通过
- [ ] 代码已经过自我审查
- [ ] 质量评估诚实可靠

---

## 质量审查报告模板

```markdown
## 质量审查报告

### 修改文件清单
1. [文件路径 1] - [修改说明]
2. [文件路径 2] - [修改说明]
...

### 质量检查结果

#### 逻辑严谨性 ✓/✗
- [具体检查项和结果]

#### 架构清晰性 ✓/✗
- [具体检查项和结果]

#### 编译质量 ✓/✗
- [具体检查项和结果]

#### 完整性 ✓/✗
- [具体检查项和结果]

#### 正确性 ✓/✗
- [具体检查项和结果]

#### 简洁性 ✓/✗
- [具体检查项和结果]

### 发现的问题和修复措施
- [问题 1]：[修复措施]
- [问题 2]：[修复措施]

### 最终评估
[整体质量评价，是否达到可交付标准]
```

---

## 使用建议

1. **打印使用**：在实施和审查时，逐项核对清单
2. **定制化**：根据项目特点，在清单中增加特定检查项
3. **持续改进**：发现遗漏的检查点时，及时补充到清单中
4. **如实记录**：不要为了"完成"而勾选，确保每项都真实检查过
